%
% Copyright Â© 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

\makeoproblem{Ray in a linear index gradient.}{modernOptics:problemSet1:2}{2012 Ps1, P2}{
What is the shape of a ray moving into a linear index gradient \cref{fig:modernOpticsProblemSet1:FigureRayLinGrad}? You'd expect something like a parabola from the intuition that the Ray Equation is `Newton-like'. Find out what you actually get! To establish some conventions: take \(n(y) = n_0 - \beta y\); choose parameterization of the ray so that \(s=0\) at the top of the trajectory: \(\Br(0) = 0\), and \(d \Br /ds = \hat{x}\) at \(s=0\). In this case the ray will remain in the \(xy\) plane, so your task is to find \(x(s)\) and \(y(s)\).
\imageFigure{../figures/phy485-optics/FigureRayLinGrad}{.}{fig:modernOpticsProblemSet1:FigureRayLinGrad}{0.2}
\begin{enumerate}
\item[(a)] Start with the Ray Equation \(\frac{d}{ds} \{ n \frac{d}{ds} \Br \} = \spacegrad n\). Integrate both sides with respect to \(s\), and use initial conditions to determine constants of integration. You should be left with two first-order differential equations.
\item[(b)] Solve the \(dy/ds\) equation first, by integrating again with respect to \(s\). Give an exact expression for \(z(s)\). Also give approximate expressions for \(y(s)\)  in two limits: small \(s\), and large \(s\).
\item[(c)] Now solve the \(dx/ds\) equation. Again, give an exact expression for \(x(s)\), and approximate expressions for \(x(s)\)  in two limits: small \(s\), and large \(s\).
\item[(d)] Combine your results to give \(x(y)\). (This may seem strange, but an exact result for \(y(x)\) is hard to write down. You'll have to restrict yourself to \(x>0\) for this curve to be functional.) You can again find an exact result, an small-s approximation, and a large-s approximation.
\item[(e)] Is the trajectory of an optical ray a parabola in any limit? If so, what is gravitational acceleration?
\item[(f)] Use your favorite software (Mathematica, ...) to make a plot of \(x(s)\), \(y(s)\), and \(x(y)\). In each plot, compare the exact expression (as a solid line) to the two limiting expressions (as dashed lines). Nondimensionalize in terms of \(L=n_0/\beta\): in other words, use the variables \(x/L\), \(y/L\), and \(s/L\).
\end{enumerate}
} % makeoproblem

\makeanswer{modernOptics:problemSet1:2}{
\begin{enumerate}
\item[(a)] Our ray equation, after computation of the gradient of the index of refraction for the material becomes
%
\begin{dmath}\label{eqn:modernOpticsProblemSet1P2:10}
\dds{} \left( n(\Br) \dds{\Br} \right)
= \spacegrad n(\Br)
= \spacegrad \left( n_0 - \beta y \right)
= -\beta \ycap.
\end{dmath}
%
In components this is
%
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:30}
\begin{aligned}
\dds{} \left( \left( n_0 - \beta y \right) \dds{x} \right) &= 0 \\
\dds{} \left( \left( n_0 - \beta y \right) \dds{y} \right) &= -\beta \\
\dds{} \left( \left( n_0 - \beta y \right) \dds{z} \right) &= 0
\end{aligned}
\end{equation}
%
Integrating once, with the introduction of \(n_0\) factors in our integration constant (which will clearly make life easier), we have
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:50}
\begin{aligned}
\left( n_0 - \beta y \right) \dds{x} &= A n_0 \\
\left( n_0 - \beta y \right) \dds{y} &= -\beta s + B n_0 \\
\left( n_0 - \beta y \right) \dds{z} &= C n_0
\end{aligned}
\end{equation}
%
In particular, at \(s = 0\), where \(x(0) = y(0) = z(0) = 0\), \(x'(0) = 1\) and \(y'(0) = z'(0) = 0\), we have
%
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:70}
\begin{aligned}
n_0 (1) &= A n_0 \\
n_0 (0) &= B n_0 \\
n_0 (0) &= C n_0
\end{aligned}
\end{equation}
%
Our equations of motion become
\boxedEquation{eqn:modernOpticsProblemSet1P2:90}{
\begin{aligned}
\left( n_0 - \beta y \right) \dds{x} &= n_0 \\
\left( n_0 - \beta y \right) \dds{y} &= -\beta s \\
\left( n_0 - \beta y \right) \dds{z} &= 0.
\end{aligned}
}

We have two non-trivial differential equations to solve.

\item[(b)]

First observe that unless \(n_0 = \beta y(s)\) for all \(s\), then \(z(s)\) must be constant.  However, our boundary condition \(\Br(0) = 0\) means that this constant is zero
%
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:110}
z(s) = \text{constant} = z(0) = 0.
\end{equation}
%
Solving for \(y(s)\) next we have after rearranging
%
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:130}
\int \left( n_0 - \beta y \right) dy = -\beta \int s ds.
\end{equation}
%
This yields
%
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:150}
n_0 y - \frac{\beta}{2} y^2 = -\frac{\beta}{2} s^2 + C.
\end{equation}
%
Noting that \(y(0) = 0\) we have \(C = 0\)
%
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:170}
y^2 - s^2 - 2 \frac{n_0}{\beta} y = 0.
\end{equation}
%
Completing the square
%
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:230}
\left( y - \frac{n_0}{\beta} \right)^2 = s^2 + \left( \frac{n_0}{\beta} \right)^2.
\end{equation}
%
or
%
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:190}
y = \frac{n_0}{\beta} \pm \sqrt{ s^2 + \left( \frac{n_0}{\beta} \right)^2 }.
\end{equation}
%
Given the \(y(0) = 0\) boundary constraint, we can only pick the negative root.  Borrowing the \(L = n_0/\beta\) notation from later in the problem, we have
\boxedEquation{eqn:modernOpticsProblemSet1P2:210}{
%y(s) = \frac{n_0}{\beta} - \sqrt{ s^2 + \left( \frac{n_0}{\beta} \right)^2 }.
y(s) = L \left( 1 - \sqrt{ \left( \frac{s}{L}\right)^2 + 1 } \right) .
}

Let's look at the small limit where \(s \ll L\)
%
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:250}
y(s)
%= L \left( 1 - \sqrt{ 1 + \left(\frac{s}{L}\right)^2 } \right)
\sim L \left( 1 - \left( 1 + \inv{2} \left(\frac{s}{L}\right)^2 \right) \right),
\end{equation}
%
\boxedEquation{eqn:modernOpticsProblemSet1P2:1890}{
y(s) \sim -\frac{s^2}{2 L} \quad \mbox{when \( s \ll L\)}.
}

In the large limit for \(s \gg L\) the \(s^2\) term dominates, leaving
\boxedEquation{eqn:modernOpticsProblemSet1P2:270}{
y(s) \sim - s \quad \mbox{when \(s \gg L\)}.
}
A plot of \(y/L\), \(-s/L\), and \(-s^2/2 L^2\) can be found in \cref{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2b} and \cref{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2bBig}.
%
\imageFigure{../figures/phy485-optics/modernOpticsProblemSet1Fig2b}{Plots of \(y(s)\) and corresponding big and small limiting forms, scaled for small limit.}{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2b}{0.2}
\imageFigure{../figures/phy485-optics/modernOpticsProblemSet1Fig2bBig}{Plots of \(y(s)\) and corresponding big and small limiting forms, scaled for large limit.}{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2bBig}{0.2}
%
\item[(c)]
We are now set to solve our x component ray equation
%
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:290}
(L - y) \dds{x} = L,
\end{equation}
%
or
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:310}
\sqrt{s^2 + L^2} \dds{x} = L.
\end{equation}
%
Integrating we have
%
\begin{dmath}\label{eqn:modernOpticsProblemSet1P2:330}
x
= L \int_0^s \frac{ds'}{\sqrt{{s'}^2 + L^2}}
= L \int_0^s \frac{ds'}{\sqrt{{s'}^2 + L^2}}
= L \int_0^{s/L} \frac{dt}{\sqrt{t^2 + 1}}
= L \evalrange{ \ln\left( t + \sqrt{ t^2 + 1} \right) }{0}{s/L}.
\end{dmath}
%
This is
\boxedEquation{eqn:modernOpticsProblemSet1P2:350}{
x(s) = L \ln\left( \frac{s}{L} + \sqrt{ \left( \frac{s}{L} \right)^2 + 1} \right).
}

In the large limit for \(s \gg L\) the \(s^2\) term in the square root dominates, leaving
\boxedEquation{eqn:modernOpticsProblemSet1P2:370}{
x(s)
\sim L \ln\left( \frac{2 s}{L} \right)
\quad \mbox{when \(s \gg L\)}.
%= L\ln 2 + L \ln \frac{s}{L}
%\sim L \ln \frac{s}{L}
}

In the small limit \(s \ll L\)
%
\begin{dmath}\label{eqn:modernOpticsProblemSet1P2:390}
x(s) \sim L \ln\left( \frac{s}{L} + 1 \right)
= L \left(
\frac{s}{L}
 -\inv{2}
\left(
\frac{s}{L}
\right)^2
 +\inv{3}
\left(
\frac{s}{L}
\right)^3
- \cdots
\right),
\end{dmath}
%
or
\boxedEquation{eqn:modernOpticsProblemSet1P2:1910}{
x(s) \sim s \quad \mbox{when \(s \ll L\)}.
}

With \(t = s/L\), we have a plot of \(u(t) = x(Lt)/L\), and the small and large limit approximations above in \cref{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2c}.
%
\imageFigure{../figures/phy485-optics/modernOpticsProblemSet1Fig2c}{Plots of \(x(s)\) and corresponding big and small limiting forms.}{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2c}{0.2}
%
\item[(d)]
With \(t = s/L\), \(u = x/L\), and \(v = y/L\) we have
%
\begin{subequations}
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:410}
u = \ln\left( t + \sqrt{t^2 + 1} \right).
\end{equation}
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:430}
v = 1 - \sqrt{t^2 + 1}.
\end{equation}
\end{subequations}
%
Rearranging for \(t\) and \(\sqrt{1 + t^2}\), we have
%
\begin{subequations}
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:450}
\sqrt{t^2 + 1} = 1 - v.
\end{equation}
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:470}
t = \sqrt{(1 - v)^2 - 1},
\end{equation}
\end{subequations}
%
so
%
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:490}
u(v) = \ln\left( \sqrt{v^2 - 2 v} + 1 - v \right).
\end{equation}
%
or
\boxedEquation{eqn:modernOpticsProblemSet1P2:510}{
x(y) = L \ln\left( \sqrt{\left(\frac{y}{L}\right)^2 - 2 \frac{y}{L}} + 1 - \frac{y}{L} \right).
}

Now, for the approximations.  Noting that the range of \(y\) is \((-\infty, 0]\) let's write \(w = -v = \Abs{v}\) in \eqnref{eqn:modernOpticsProblemSet1P2:490} so that we have
%
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:490b}
u(w) = \ln\left( \sqrt{w^2 + 2 w} + 1 + w \right).
\end{equation}
%
For \(w >> 1\) we have
%
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:610}
\sqrt{w^2 + w} \sim \sqrt{w^2} = w = -y/L.
\end{equation}
%
so that
\boxedEquation{eqn:modernOpticsProblemSet1P2:490c}{
x(y) \sim L \ln\left( -\frac{2 y}{L} \right) \quad \mbox{when \(-y/L \gg 1\)}.
}

In the small limit \(w << 1\) we also have \(w^2 \ll w\), so that
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:630}
u(w)
\sim \ln( \sqrt{w} + 1)
\sim \sqrt{w} - \inv{2} (\sqrt{w})^2 + \inv{3}(\sqrt{w})^3 - \cdots
\sim \sqrt{w},
\end{equation}
%
or
\boxedEquation{eqn:modernOpticsProblemSet1P2:650}{
x(y) \sim L \sqrt{-\frac{y}{L}} \quad \mbox{when \(-y/L \ll 1\)}.
}

A plot of \(x(y/L)/L\), and the small and large limit approximations can be found in \cref{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2d} and \cref{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2dBig}.
%
\imageFigure{../figures/phy485-optics/modernOpticsProblemSet1Fig2d}{Plots of \(x(y/L)/L\) and corresponding big and small limiting forms, scaled for small limit.}{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2d}{0.2}
%
\imageFigure{../figures/phy485-optics/modernOpticsProblemSet1Fig2dBig}{Plots of \(x(y/L)/L\) and corresponding big and small limiting forms, scaled for large limit.}{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2dBig}{0.2}
%
\item[(e)]
In the small limit we found
%
\begin{subequations}
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:530}
x(s) \sim s.
\end{equation}
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:550}
y(s) \sim -\frac{s^2}{2 L},
\end{equation}
\end{subequations}
%
so we have
%
\begin{equation}\label{eqn:modernOpticsProblemSet1P2:570}
y \sim -\frac{x^2}{2 L},
\end{equation}
%
a parabolic trajectory.  Comparing to \(y'' = g\), where \(y = g t^2/2 + y_0' t + y_0\), the quantity that's analogous to the gravitational acceleration in \eqnref{eqn:modernOpticsProblemSet1P2:570} is
\boxedEquation{eqn:modernOpticsProblemSet1P2:590}{
- \inv{L} = -\frac{\beta}{n_0} \rightarrow g.
}
\item[(f)]
These plots were included above.  Good asymptotic matching in the large limit was found to be fairly range dependent, also shown above.  This can be observed in \nbref{modernOpticsProblemSet1.cdf}, where dynamic (Manipulate) graphs are available for each of the graphs above, where the range is slider parameterized.
\end{enumerate}
} % makeanswer
