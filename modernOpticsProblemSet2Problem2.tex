%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeoproblem{Fresnel Lens.}
{modernOptics:problemSet2:2}
{2012 Ps2, P2}
{

In this problem you will design a Fresnel lens that focuses a plane wave onto a line (ie, a cylindrical lens). Design it for wavelength \(\lambda\) and a focal length \(f\). The on-axis Fresnel diffraction integral we found in class was
\( \Psi = \frac{\Psi_\infty }{2 i} \int\int du \, dv \, \exp{[i \frac{\pi}{2} (u^2 + v^2)]}, \)
where \(u = x' \sqrt{2 (r_S^{-1} + r^{-1})/\lambda} \), and a similar expression applied for \(v\) as a function of \(y'\). The goal of the design is to maximize the intensity at the focus of the lens, located at \(\Br = \langle 0, 0, f \rangle\). We'll call this amplitude \(\Psi_f\) and this intensity \(I_f\).

The variables to be used for the Fresnel mask transitions is illustrated in \cref{fig:modernOpticsProblemSet2Problem2:modernOpticsProblemSet2Problem2Fig1}.
%
\imageFigure{../figures/phy485-optics/modernOpticsProblemSet2Problem2Fig1}{Notation for Fresnel lens mask.}{fig:modernOpticsProblemSet2Problem2:modernOpticsProblemSet2Problem2Fig1}{0.15}
%
\makesubproblem{
Integrate out the \(y'\) direction, so that we are only dealing with an integral of \(u\). Give an expression for the contribution to \(\Psi_f\) from an open segment from \(u=a\) to \(u=b\), in terms of the Fresnel Integrals \(\calS(u)\) and \(\calC(u)\).
}{modernOptics:problemSet2:2a}
\makesubproblem{
As a first step in the design, consider a Fresnel lens with only one opening, from \(-u_0\) to \(u_0\). Plot the resultant intensity \(I_f/I_\infty\) versus \(u_0\). {\em You will need numerical evaluation of the Fresnel integrals for parts \ref{modernOptics:problemSet2:2b} and \ref{modernOptics:problemSet2:2e} of this problem.}
}{modernOptics:problemSet2:2b}
\makesubproblem{
The next step is to find subsequent open regions  (I'll call these zones) of the mask that most increase \(I_f\). These zones need to chosen to have a phase that matches the amplitude passing through the central zone. {\bf Illustrate this principle with a drawing of the Cornu spiral}, showing what segments should be blocked.
}{modernOptics:problemSet2:2c}
\makesubproblem{
From (c), show that this criterion results in zone edges at \(\pm u_m\), where \(u_m = \sqrt{3/2 + 2 m}\), and \(m=\{ 0, 1, 2, \ldots \}\). {\em Hint: recall that the angle of the spiral is \(\beta = \frac{\pi}{2} u^2\). }
}{modernOptics:problemSet2:2d}
\makesubproblem{
Calculate the increase in intensity with three open zones and with five open zones.
}{modernOptics:problemSet2:2e}
\makesubproblem{
Give a pathlength interpretation of the expression for \(u_m\).
}{modernOptics:problemSet2:2f}
\makesubproblem{
If this is an x-ray Fresnel lens, where \(\lambda=10\)\,nm and \(f=10\)\,cm, how big is the central opening? Take the plane wave limit \(r_s \rightarrow \infty\). If we can only fabricate zones as small as 1\(\mu\)m, how many zones could we make?
}{modernOptics:problemSet2:2g}
} % makeoproblem

\makeanswer{modernOptics:problemSet2:2}{
\paragraph{Part \ref{modernOptics:problemSet2:1a}.}

Performing the \(y\) (\(v\)) integration we find for our wavefunction
%
\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P2:20}
\Psi
=
\frac{\Psi_\infty}{2 i}
\int du e^{i \pi u^2/2} du
\int_{-\infty}^\infty du e^{i \pi u^2/2} du
=
\frac{\Psi_\infty}{2 i}
\int du e^{i \pi u^2/2} du
\left(
2 \int_{0}^\infty du e^{i \pi u^2/2} du  \right)
=
\frac{\Psi_\infty}{2 i}
\int du e^{i \pi u^2/2} du
2 \left( \inv{2} + \frac{i}{2} \right)
=
\frac{\Psi_\infty}{2} (1 - i)
\int du e^{i \pi u^2/2} du,
\end{dmath}
%
so for an interval \([a, b]\) we have for the wavefunction observed at \(\Br = (0, 0, f)\)
%
\begin{equation}\label{eqn:modernOptics:ProblemSet2:P2:40}
\Psi_f =
\frac{\Psi_\infty}{2} (1 - i)
\evalrange{ (C(s) + iS(s)) }{a}{b}.
\end{equation}
%
\paragraph{Part \ref{modernOptics:problemSet2:2b}.}

Setting the interval to \([-u_0, u_0]\) we have, noting that \(S(-s) = -S(s)\) and \(C(-s) = -C(s)\)
%
\begin{equation}\label{eqn:modernOptics:ProblemSet2:P2:60}
\Psi_f =
\Psi_\infty (1 - i)
\left( C(u_0) + iS(u_0) \right).
\end{equation}
%
The ratio of intensities is
%
\begin{equation}\label{eqn:modernOptics:ProblemSet2:P2:80}
\frac{I_f}{I_\infty} = 2 \left( C^2(u_0) + S^2(u_0) \right),
\end{equation}
%
which is plotted in \cref{fig:modernOpticsProblemSet2Problem2:modernOpticsProblemSet2Problem2Fig2}.
%
\imageFigure{../figures/phy485-optics/modernOpticsProblemSet2Problem2Fig2}{Intensity ratio vs \(u_0\).}{fig:modernOpticsProblemSet2Problem2:modernOpticsProblemSet2Problem2Fig2}{0.2}
%
Numerically, we find that the peak of the first lobe falls at \(u_0 \sim 1.21\).  A plot of the Cornu spiral up to this point of maximum intensity is found in \cref{fig:modernOpticsProblemSet2Problem2:modernOpticsProblemSet2Problem2Fig2b}.  Visually it appears that the angle at the termination of this region is \(3\pi/4\) which is consistent with \(u_0 = \sqrt{3/2}\), since the angle at \(u_0\) is \(\pi (3/2)/2\).
%
\imageFigure{../figures/phy485-optics/modernOpticsProblemSet2Problem2Fig2b}{Cornu spiral segment up to the point of the max intensity ratio.}{fig:modernOpticsProblemSet2Problem2:modernOpticsProblemSet2Problem2Fig2b}{0.2}
%
\paragraph{Parts \ref{modernOptics:problemSet2:2c}, \ref{modernOptics:problemSet2:2d}.}

For an aperture open in the interval \([-u_2, -u_1]\) and \([u_1, u_2]\) we have
%
\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P2:100}
\Psi_f
=
\frac{\Psi_\infty}{2} (1 - i)
\left(
C(u_2) + iS(u_2) -C(u_1) - iS(u_1)
+ C(-u_1) + iS(-u_1) -C(-u_2) - iS(-u_2)
\right)
=
\Psi_\infty (1 - i)
\left(
C(u_2) + iS(u_2) -C(u_1) - iS(u_1)
\right).
\end{dmath}
%
Should we with to add this non-destructively to our wavefunction for the \([-u_0, u_0]\) range, we need to match the phases of these functions, or
%
\begin{equation}\label{eqn:modernOptics:ProblemSet2:P2:120}
\frac{S[u_0]}{C[u_0]}
=
\frac{S[u_2] - S[u_1]}{C[u_2] - C[u_1]}.
\end{equation}
%
For Part \ref{modernOptics:problemSet2:2d} we are asked to show that the zone edges are found at \(u_m = \sqrt{3/2 + 2m}\), given that the tangential angles at those points are \(\pi u_m^2/2\).  That is
%
\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P2:140}
\theta(u_m)
= \frac{\pi}{2} u_m^2
= \frac{\pi}{2} \left( \frac{3}{2} + 2m \right)
= \frac{3 \pi}{4} + m \pi.
\end{dmath}
%
This gives us
%
\begin{equation}\label{eqn:modernOptics:ProblemSet2:P2:160}
\begin{aligned}
\theta(u_0) &= \frac{3 \pi}{4}  \\
\theta(u_1) &= \frac{3 \pi}{4} + \pi \\
\theta(u_2) &= \frac{3 \pi}{4} + 2 \pi
\hdots &
\end{aligned}
\end{equation}
%
so that the difference between the tangential angle at \(u_m\) and \(u_{m-1}\) is \(\pi\).  In the upper right quadrant of the spiral we see that blocking the intervals \([u_{2k}, u_{2k+1}]\) will provide, approximately, the desired phase matching of \eqnref{eqn:modernOptics:ProblemSet2:P2:120}.  This masking is illustrated in \cref{fig:modernOpticsProblemSet2Problem2CornuSpiralMasked:modernOpticsProblemSet2Problem2CornuSpiralMaskedFig4}.

% original logic:
%\imageFigure{../figures/phy485-optics/modernOpticsProblemSet2Problem2CornuSpiralMaskedFig4}{Cornu Spiral with regions blocked for equal phase differences.}{fig:modernOpticsProblemSet2Problem2CornuSpiralMasked:modernOpticsProblemSet2Problem2CornuSpiralMaskedFig4}{0.3}
% fudging the logic:
\imageFigure{../figures/phy485-optics/modernOpticsProblemSet2Problem2CornuSpiralMaskedFig4a}{Cornu Spiral with regions blocked for equal phase differences.}{fig:modernOpticsProblemSet2Problem2CornuSpiralMasked:modernOpticsProblemSet2Problem2CornuSpiralMaskedFig4}{0.3}
%
\paragraph{Part \ref{modernOptics:problemSet2:2e}.  }

The respective wave functions for each of the non-blocked intervals chosen are
\begin{itemize}
\item \( [-u_0, u_0]\):
\begin{dmath}\label{eqn:modernOpticsProblemSet2Problem2:380}
\Psi_{f0} = \Psi_\infty (1 - i) \left( C\left(\sqrt{3/2}\right) + i S\left(\sqrt{3/2}\right) \right) .
\end{dmath}
\item \( [-u_2, -u_1] \cup [u_1, u_2] \):
\begin{dmath}\label{eqn:modernOpticsProblemSet2Problem2:400}
\Psi_{f2} = \Psi_\infty (1 - i) \left( C\left(\sqrt{11/2}\right) - C\left(\sqrt{7/2}\right) + i S\left(\sqrt{11/2}\right) - iS\left(\sqrt{7/2}\right) \right) .
\end{dmath}
\item \( [-u_4, -u_3] \cup [u_3, u_4] \):
\begin{dmath}\label{eqn:modernOpticsProblemSet2Problem2:420}
\Psi_{f4} = \Psi_\infty (1 - i) \left( C\left(\sqrt{19/2}\right) - C\left(\sqrt{15/2}\right) + i S\left(\sqrt{19/2}\right) - iS\left(\sqrt{15/2}\right) \right) .
\end{dmath}
\end{itemize}
%\begin{equation}\label{eqn:modernOptics:ProblemSet2:P2:180}
%[-u_6, -u_5] \cup [u_5, u_6] &\quad \Psi_{f4} = \Psi_\infty (1 - i) \left( C\left(\sqrt{27/2}\right) - C\left(\sqrt{23/2}\right) + i S\left(\sqrt{27/2}\right) - iS\left(\sqrt{23/2}\right) \right)
%\vdots \\
%[-u_8, -u_7] \cup [u_7, u_8] &\quad \Psi_{f6} = \Psi_\infty (1 - i) \left( C\left(\sqrt{35/2}\right) - C\left(\sqrt{31/2}\right) + i S\left(\sqrt{35/2}\right) - iS\left(\sqrt{31/2}\right) \right) \\
%\end{equation}
Numerically, we find the values
\begin{dmath}\label{eqn:modernOpticsProblemSet2Problem2:n}
0.742832, 0.713766, 0.747819,
\end{dmath}
which.  As expected, these \(\arg(\Delta C + i \Delta S)\) values are not perfect matches, as we expected by looking at the graph of the Cornu spiral.  They are however good approximations, and the destructive interference with summation should be minimal.

We want to compare the intensities of the sums of these (one, three, and five open zones respectively)
%
\begin{equation}\label{eqn:modernOptics:ProblemSet2:P2:200}
\begin{aligned}
\Psi_0 = \Psi_{f0} &= \Psi_\infty 1.34171 e^{ -0.0425663 i } \\
\Psi_{f0} + \Psi_{f2} &= \Psi_\infty 1.76859 e^{ -0.0495833 i } \\
\Psi_{f0} + \Psi_{f2} + \Psi_{f4} &= \Psi_\infty 2.0779 e^{ -0.0477963 i }
\end{aligned}
\end{equation}
%
The phase change with each addition is because the \(\Delta C + i \Delta S\) values evaluated over the \([u_{2k-1}, u_{2k}]\) intervals with \(u_m = \sqrt{3/2 + 2m}\) were based on tangential angles, and picking those tangential angles with this \(\pi\) separation, will rotate slightly with each iteration into the spiral.  A more exact numerical choice for the \(u_m\) end points is required to avoid this, but we see that this was good enough to increase the magnitude (and thus the intensity) with each additional pair of opened apertures.

Squaring the absolute values in the wave functions above we find with \(1, 3, and 5\) openings, the following intensity ratios
%
\begin{equation}\label{eqn:modernOptics:ProblemSet2:P2:220}
\begin{aligned}
\frac{I_{1}}{I_\infty} &= 1.80018 \\
\frac{I_{3}}{I_\infty} &= 3.12791 \\
\frac{I_{5}}{I_\infty} &= 4.31767
\end{aligned}
\end{equation}
%
So, the first pair of additional openings results in a \(1.7\) times increase in intensity compared to the single opening, and the second pair of additional openings results in a \(2.4\) times intensity increase compared to the single opening.

\paragraph{Part \ref{modernOptics:problemSet2:2f}.  }

To relate this back to pathlength we note that we have for \(r_s \rightarrow \infty\)
%
\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P2:240}
u_m
= x_m \sqrt{ \frac{2}{\lambda} \left( \inv{r_s} + \inv{r_m} \right) }
\sim
x_m \sqrt{ \frac{2}{\lambda r_m} }
\sim
x_m \sqrt{ \frac{2}{\lambda f} },
\end{dmath}
%
or
\begin{equation}\label{eqn:modernOptics:ProblemSet2:P2:260}
x_m \sim u_m \sqrt{ \frac{\lambda f}{2} }.
\end{equation}
%
Looking to \cref{fig:modernOpticsProblemSet2Problem2:modernOpticsProblemSet2Problem2Fig3} we see that we have
%
\imageFigure{../figures/phy485-optics/modernOpticsProblemSet2Problem2Fig3}{Geometry for path length interpretation.}{fig:modernOpticsProblemSet2Problem2:modernOpticsProblemSet2Problem2Fig3}{0.3}
%
\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P2:280}
r_m
= \sqrt{f^2 + x_m^2}
= f \sqrt{ 1 + \frac{x_m^2}{f^2} }
\sim f \left( 1 + \inv{2} \frac{x_m^2}{f^2} \right)
= f + \inv{2} \frac{x_m^2}{f}.
\end{dmath}
%
Illustrating first with the representative \([x_1, x_2]\) interval, observe that the ray distance from the midpoint is
%
\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P2:300}
\inv{2} (r_2 + r_1) \sim
\inv{2} \left(
f + \inv{2} \frac{x_2^2}{f}
+f + \inv{2} \frac{x_1^2}{f}
\right)
=
f + \inv{2 f} \left( x_1^2 + x^2 \right)
=
f + \frac{\lambda f}{8 f} ( u_1^2 + u_2^2 )
=
f + \frac{\lambda}{8} ( u_1^2 + u_2^2 ).
\end{dmath}
%
A bit more generally we see that the average additional pathlength at the midpoint of the aperture is
%
\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P2:320}
\frac{r_{2m} + r_{2m-1}}{2} - f
= \frac{\lambda}{8} \left( u_{2m}^2 + u_{2m-1}^2 \right)
= \frac{\lambda}{8} \left( \frac{3}{2} + 4 m + \frac{3}{2} + 2 (2m -1) \right)
= \frac{\lambda}{8} \left( 3 + 8 m - 1 \right)
= \lambda \left( m + \inv{8} \right).
\end{dmath}
%
We are adding about an additional \(\lambda\) of pathlength from each aperture, resulting in constructive instead of destructive interference.

\paragraph{Part \ref{modernOptics:problemSet2:2g}.  }

The central opening for these values is
%
\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P2:340}
2 x_0
\sim 2 u_0 \sqrt{ \lambda f/2 }
= 2 \sqrt{ \frac{3}{2} \frac{\lambda f}{2} }
= \sqrt{ 3 \lambda f }
= \sqrt{ 3 (10 \times 10^{-9})(10^{-1}) } \text{m}
\sim 55 \mu \text{m}.
\end{dmath}
%
To determine how many zones we can make, we note that the size of one of the openings in each pair of additional zones is
%
\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P2:360}
x_{2k} - x_{2k-1}
\sim
(u_{2k} - u_{2k-1} )
\sqrt{ \frac{\lambda f}{2} }
=
\sqrt{ \frac{\lambda f}{2} }
\left(
\sqrt{ \frac{3}{2} + 4 k }
-\sqrt{ \frac{3}{2} + 4 k - 2 }
\right) > 10^{-6},
\end{dmath}
%
which after substitution of our numbers is the numerical problem of finding the biggest integer \(k\) for which
%
\begin{dmath}\label{eqn:modernOptics:ProblemSet2:P2:340b}
\sqrt{ 8 k + 3 } - \sqrt{ 8 k - 1 } > \inv{5 \sqrt{10}}.
\end{dmath}
%
%NSolve[ Sqrt[8 k + 3] - Sqrt[ 8 k - 1 ] > 1/(5 Sqrt[10]) && k > 0, k, Integers]
We find the largest value is \(k = 124\) (can make 124 additional pairs of openings after the central opening), or 249 zones in total.

%\makesubanswer{TODO.}{modernOptics:problemSet2:2a}
%\makesubanswer{TODO.}{modernOptics:problemSet2:2b}
%\makesubanswer{TODO.}{modernOptics:problemSet2:2c}
%\makesubanswer{TODO.}{modernOptics:problemSet2:2d}
%\makesubanswer{TODO.}{modernOptics:problemSet2:2e}
%\makesubanswer{TODO.}{modernOptics:problemSet2:2f}
%\makesubanswer{TODO.}{modernOptics:problemSet2:2g}
} % makeanswer
