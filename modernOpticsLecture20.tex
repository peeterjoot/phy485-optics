%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{modernOpticsLecture20}
%\renewcommand{\dirname}{notes/phy485/}
%\newcommand{\keywords}{Optics, PHY485H1F}
%\input{../peeter_prologue_print2.tex}
%
%\usepackage[draft]{fixme}
%\fxusetheme{color}
%
%\beginArtNoToc
%\generatetitle{PHY485H1F Modern Optics.  Lecture 20: Guoy phase shifts and higher order Gaussian modes.  Taught by Prof.\ Joseph Thywissen}
%%\chapter{Guoy phase shifts and higher order Gaussian modes}
\index{Guoy phase shift}
\index{Gaussian modes}
%\label{chap:modernOpticsLecture20}
%
%\section{Disclaimer}
%
%Peeter's lecture notes from class.  May not be entirely coherent.

\section{Guoy phase shifts, higher order modes.}
\paragraph{Review}
We'd found for the first order Gaussian beam
\begin{dmath}\label{eqn:modernOpticsLecture20:10}
u_{00} = \frac{w_0}{w(z)}
\exp
\left(
-\frac{r^2}{w^2(z)} + \frac{i k_0 r^2}{R(z)} - i \phi(z)
\right).
\end{dmath}
%
\begin{dmath}\label{eqn:modernOpticsLecture20:30}
w^2(z) = w_0^2 \left(
1 + \frac{z^2}{z_0^2}
\right).
\end{dmath}
%
\begin{dmath}\label{eqn:modernOpticsLecture20:50}
z_0 = \frac{\pi w_0^2}{\lambda}.
\end{dmath}
%
\begin{dmath}\label{eqn:modernOpticsLecture20:70}
\inv{R(z)} = \frac{z}{z^2 + z_0^2}.
\end{dmath}
%
\begin{dmath}\label{eqn:modernOpticsLecture20:90}
\phi(z) = \Atan\left(
\frac{z}{z_0}
\right).
\end{dmath}
%
Our complete wave was
%
\begin{dmath}\label{eqn:modernOpticsLecture20:110}
\Psi(x, y, z) = \Psi_0 u(x, y, z) e^{i k_0 z - i \omega t}.
\end{dmath}
%
In particular, along the z-axis, where \(\phi(0) = 0\) and \(r^2 = 0\), we have
%
\begin{dmath}\label{eqn:modernOpticsLecture20:130}
\Psi(0, 0, z) = \Psi_0 \frac{w_0}{w(z)} e^{i k_0 z - i \omega t}.
\end{dmath}
%
\paragraph{Guoy phase shift}
\index{Guoy!phase shift}

Guoy's work was circa 1890.  Was that experimental or theoretical work?  Some references can be found in \citep{winful2001physical}.

Let's consider the \underlineAndIndex{phase velocity} at \(z \ll z_0\).

%\cref{fig:modernOpticsLecture20:modernOpticsLecture20Fig1}.
%\imageFigure{../figures/phy485-optics/modernOpticsLecture20Fig1}{CAPTION.}{fig:modernOpticsLecture20:modernOpticsLecture20Fig1}{0.3}
%
We want to consider the constant curves
%
\begin{dmath}\label{eqn:modernOpticsLecture20:150}
-i \phi(z) + i k_0 z - i \omega t = i \text{constant}.
\end{dmath}
%
See \citep{velocityOfaMechanicalWave} for a quick and nicely written reminder of why we are looking at constant phase fronts.

Taking time derivatives of \(\phi\), using chain rule and \eqnref{eqn:modernOpticsLecture20AtanDerivativeProblem:790}, we have
%
\begin{dmath}\label{eqn:modernOpticsLecture20:210}
\ddt{\phi}
= \ddt{z} \ddz{\phi}
= \ddt{z} \frac{z_0}{z^2 + z_0^2}.
\end{dmath}
%
The time derivative of \eqnref{eqn:modernOpticsLecture20:150} is then
%
\begin{dmath}\label{eqn:modernOpticsLecture20:230}
-i
\ddt{z} \frac{z_0}{z^2 + z_0^2}
+ i k_0 \ddt{z} - i \omega = 0.
\end{dmath}
%
Solve for the phase velocity \(V_{\mathrm{ph}} = dz/dt\), we find
%
\boxedEquation{eqn:modernOpticsLecture20:250}{
\begin{aligned}
\ddt{z} &= V_{\mathrm{ph}}
= \frac{\omega}{k_{\mathrm{eff}}} \\
k_{\mathrm{eff}} &= k_0 - \frac{z_0}{z^2 + z_0^2}
\end{aligned}
}

We can write this as
%
\begin{dmath}\label{eqn:modernOpticsLecture20:650}
\frac{k_{\mathrm{eff}}}{k_0}
= 1 - \frac{2}{k_0^2 \omega_0^2} \inv{ 1 + (z/z_0)^2},
\end{dmath}
%
We have \(k_{\mathrm{eff}} > 0\) provided \((z/z_0)^2 > 2/(k_0 \omega_0)^2 -1\).  We have \(k_{\mathrm{eff}}\) take its maximum of \(k_0\) as \(z \rightarrow \infty\), and takes its minimum value at \(z = 0\) of
%
\begin{dmath}\label{eqn:modernOpticsLecture20:290}
k_{\mathrm{eff}}
%= k_0 - \frac{1}{z_0}
= k_0 - \frac{2}{k_0 \omega_0^2}.
\end{dmath}
%
We plot \(k_{\mathrm{eff}}/k_0\) as a function of \(z/z_0\) with \(2/(k_0 \omega_0^2) = 1/10\) in \cref{fig:modernOpticsLecture20:modernOpticsLecture20Fig5}.
%
\imageFigure{../figures/phy485-optics/modernOpticsLecture20Fig5}{Effective Phase velocity.}{fig:modernOpticsLecture20:modernOpticsLecture20Fig5}{0.3}
%
Since \(k_{\mathrm{eff}} < k_0\) for all \(z\) we have \(V_{\mathrm{ph}} > \omega/k_0\), or
%
\begin{equation}\label{eqn:modernOpticsLecture20:270}
V_{\mathrm{ph}} > c.
\end{equation}
%
Our phase velocity always exceeds the speed of light.

%FIXME: what was the significance of this \(z = 0\) value of \(k_{\mathrm{eff}}\)?
\paragraph{Cavity}
\index{cavity}

\begin{itemize}
\item Mode to be a solution of cavity.  Mirror ``undoes'' propagation.
\item Round trip phase shift is \(2 \pi (\text{integer})\) for resonance.
\end{itemize}

\cref{fig:modernOpticsLecture20:modernOpticsLecture20Fig2}.
\imageFigure{../figures/phy485-optics/modernOpticsLecture20Fig2}{Gaussian mode confined in cavity by a set of mirrors.}{fig:modernOpticsLecture20:modernOpticsLecture20Fig2}{0.2}
%
\paragraph{Higher order modes}
%
%\fxwarning{plug this to wave equation and verify}
%
\begin{dmath}\label{eqn:modernOpticsLecture20:310}
u_{lm} (x, y, z) \sim \frac{w_0}{w(z)}
\exp
\left(
-\frac{r^2}{w^2(z)} + \frac{i k_0 r^2}{R(z)} - i (m + l + 1) \phi(z)
\right)
%\times
H_l \left(
\frac{\sqrt{2} x}{w(z)}
\right)
H_m \left(
\frac{\sqrt{2} y}{w(z)}
\right).
\end{dmath}
%
\begin{equation}\label{eqn:modernOpticsLecture20:330}
\begin{aligned}
H_0(x) &= 1 \\
H_1(x) &= 2 x \\
H_2(x) &= 4 x^2 - 1
\end{aligned}
\end{equation}
%
Now get
%
\begin{equation}\label{eqn:modernOpticsLecture20:350}
k_{\mathrm{eff}} = k_0 - ( m + l + 1) \frac{z_0}{z^2 + z_0^2}.
\end{equation}
%
\paragraph{Beam parameter}
\index{beam parameter}

We want to look at how the Gaussian beam interacts with mirrors, as in \cref{fig:modernOpticsLecture20:modernOpticsLecture20Fig3}, to get an idea of how the beam will behave in a cavity (without starting over at the Helmholtz equation).  Bringing back in our \(q\) notation
%
\imageFigure{../figures/phy485-optics/modernOpticsLecture20Fig3}{Gaussian modes confined to mirror cavity.}{fig:modernOpticsLecture20:modernOpticsLecture20Fig3}{0.2}
%
It turns out that we can consider an equivalent system of mirrors in series as in \cref{fig:modernOpticsLecture20:modernOpticsLecture20Fig4}.
%
\imageFigure{../figures/phy485-optics/modernOpticsLecture20Fig4}{Equivalent to mirror cavity.}{fig:modernOpticsLecture20:modernOpticsLecture20Fig4}{0.15}
%
\begin{equation}\label{eqn:modernOpticsLecture20:370}
\inv{q(z)} = \inv{R(z)} + i \frac{\lambda}{\pi w^2(z)}.
\end{equation}
%
where \(\Real \inv{q(z)}\) gives curvature, and \(\Imag \inv{q(z)}\) gives beam radius.

Now
%
\begin{dmath}\label{eqn:modernOpticsLecture20:390}
u_{lm}
= \frac{c_{lm}}{w(z)} H_l H_m e^{\frac{i k_0 r^2}{2 q}} e^{-i (l + m + 1) \phi}.
\end{dmath}
\begin{dmath}\label{eqn:modernOpticsLecture20:410}
u_{00}
= \frac{w_0}{w(z)} e^{\frac{i k_0 r^2}{2 q}} e^{-i \phi}.
\end{dmath}
%
Found in uniform medium
%
\begin{equation}\label{eqn:modernOpticsLecture20:430}
q(z) = z - i z_0.
\end{equation}
%
Know that if \(q_1\) at some position \(z_1\) then at \(z_2\)
%
\begin{equation}\label{eqn:modernOpticsLecture20:450}
q_2 = q_1 + (z_2 - z_1).
\end{equation}
%
\paragraph{M\"obius Transform}
\index{M\"obius transform}
%
\begin{equation}\label{eqn:modernOpticsLecture20:470}
q' = \frac{ A q + B }{C q + D}.
\end{equation}
%
where coefficients same as we used in geometric optics

i.e. \(A\), \(B\), \(C\), \(D\) transformation, such as that of a lens:
%
\begin{equation}\label{eqn:modernOpticsLecture20:490}
M =
\begin{bmatrix}
1 & 0 \\
-\inv{f} & 1
\end{bmatrix}
\end{equation}
%
(\(A = 1\), \(B = 0\), \(C = -1/f\), \(D = 1\)).

This happens to be (not to be proven) that this is exactly how a Gaussian lens behaves when it encounters a lens/mirror/...

For a lens interaction we have
%
\begin{equation}\label{eqn:modernOpticsLecture20:530}
q' = \frac{(1) q + (0)}{(-1/f) q + (1)} = \inv{-\inv{f} + \inv{q}}.
\end{equation}
%
\makeexample{Check for free propagation}{example:WHAT:1}{
%
\begin{equation}\label{eqn:modernOpticsLecture20:550}
M =
\begin{bmatrix}
1 & L \\
0 & 1
\end{bmatrix}
\end{equation}
%
\begin{equation}\label{eqn:modernOpticsLecture20:510}
q' = \frac{(1) q + (L)}{(0)q + (1)} = q + L.
\end{equation}
%
which is what we know from \eqnref{eqn:modernOpticsLecture20:450}.
}

\makeexample{With lens transfer matrix}{example:WHAT:2}{
For the lens transformation of \eqnref{eqn:modernOpticsLecture20:530} we have
%
\begin{equation}\label{eqn:modernOpticsLecture20:570}
\inv{q'} = \inv{q} - \inv{f}.
\end{equation}
%
so that
%
\begin{equation}\label{eqn:modernOpticsLecture20:590}
u = e^{\frac{i k_0 r^2}{2 q}} \rightarrow u e^{-\frac{i k_0 r^2}{2 f}}.
\end{equation}
}

\paragraph{Structure of M\"obius transformation for rays}

The Van Driel notes make a nice observation about the relation between the M\"obius transformation and the matrix transformation.  For
%
\begin{dmath}\label{eqn:modernOpticsLecture20:670}
\begin{bmatrix}
y' \\
\alpha'
\end{bmatrix}
=
\begin{bmatrix}
A & B \\
C & D
\end{bmatrix}
\begin{bmatrix}
y \\
\alpha
\end{bmatrix}
\end{dmath}
%
We can relate \(y'/\alpha'\) and \(y/\alpha\) as follows
%
\begin{subequations}
\begin{dmath}\label{eqn:modernOpticsLecture20:690}
y' = A y + B \alpha.
\end{dmath}
\begin{dmath}\label{eqn:modernOpticsLecture20:710}
\alpha' = C y + D \alpha.
\end{dmath}
\end{subequations}
%
So that
%
\begin{dmath}\label{eqn:modernOpticsLecture20:730}
\frac{y'}{\alpha'} = \frac{A y + B \alpha}{ C y + D \alpha}.
\end{dmath}
%
This takes some of the mystery about the equivalence out of the picture since we see the structure of the M\"obius transformation in this ratio, even for plain old rays.  It would still be nice to see a proof of exactly how that applies to the Gaussian beams.

\paragraph{Cavity stability}
\index{cavity stability}

See: slides.

The criteria is
%
\begin{equation}\label{eqn:modernOpticsLecture20:610}
0 < g_1 g_2 < 1.
\end{equation}
%
where we introduce dimensionless quantities
%
\begin{equation}\label{eqn:modernOpticsLecture20:630}
g_{1,2} = 1 - \frac{L}{R_{1,2}}.
\end{equation}
%
